# -*- coding: utf-8 -*-
"""Ogonna_10581483_CA_2.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/15PnJFrD4P0268iYV5vk1SHrtli2gj_bI
"""

#Author: Ogonna Okanu
#Code: Creating a data analysis pipeline
#Date: 04/04/2024
#Version: 1.5

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

data_set = pd.read_csv("/content/Dataset.csv")

df = pd.DataFrame(data_set)

df['runtime'] = df['runtime'].str.replace(' min', '').str.replace(',', '').astype(float)
df['votes'] = df['votes'].str.replace(',', '').astype(int)

#Classifying the ratings of Certificates
plt.figure(figsize=(10,6))
sns.countplot(x='certificate', color = 'skyblue', data = df)
plt.title('Certificate Ratings Classification')
plt.xlabel('Certificate Ratings')
plt.ylabel('Count')
plt.xticks(rotation=45)
plt.show()

#Average ratings by genre

plt.figure(figsize=(12,6))
sns.barplot(x='genre', y='rating', color = 'green', data=df, ci = None)
plt.title('Average Rating by Genre')
plt.xlabel('Genre')
plt.ylabel('Average Rating')
plt.xticks(rotation=90)
plt.show()

#comparing the relationship between runtime and rating

plt.figure(figsize=(10,6))
sns.scatterplot(x='runtime', y='rating', color = 'red', data=df)
plt.title('Runtime vs Rating')
plt.xlabel('Runtime(mins)')
plt.ylabel('Rating')
plt.show()

#shows patterns in voting

plt.figure(figsize=(10,6))
sns.histplot(df['votes'], bins=20, color = 'yellow', kde = True)
plt.title('Votes Distribution')
plt.xlabel('Number of Votes')
plt.ylabel('Count')
plt.show()

